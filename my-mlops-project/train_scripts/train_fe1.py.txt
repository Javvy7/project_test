#!/usr/bin/env python
# coding: utf-8

from src.fe1.fe1 import FeatureEngineering1
import pandas as pd

bucket_name = 'dataminds-warehouse'
s3_file_key = 'data_usage_production.parquet'
local_file_path = 'data_usage_production.parquet'

FeatureEngineering1.download_from_s3 = staticmethod(lambda bucket_name, s3_file_key, local_file_path: __import__('boto3').client('s3').download_file(bucket_name, s3_file_key, local_file_path))
FeatureEngineering1.download_from_s3(bucket_name, s3_file_key, local_file_path)

df = pd.read_parquet(local_file_path)

fe1 = FeatureEngineering1(df, target_column='data_compl_usg_local_m1')
fe1.sample_and_index()
fe1.split_data()
fe1.create_preprocessor()
fe1.train_model()
fe1.evaluate()
fe1.hyperparameter_search()
